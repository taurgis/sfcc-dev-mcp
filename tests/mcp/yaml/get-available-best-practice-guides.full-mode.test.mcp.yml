# ==================================================================================
# SFCC MCP Server - get_available_best_practice_guides Tool YAML Tests
# Tests deprecation notice functionality - tools now return deprecation notices
# pointing users to GitHub Copilot Agent Skills
#
# Quick Test Commands:
# aegis "tests/mcp/yaml/get-available-best-practice-guides.full-mode.test.mcp.yml" --config "aegis.config.json.json" --verbose
# ==================================================================================
description: "SFCC MCP Server get_available_best_practice_guides tool - deprecation notice validation (full-mode)"

tests:
  - it: "should list get_available_best_practice_guides tool in available tools"
    request:
      jsonrpc: "2.0"
      id: "tool-list-1"
      method: "tools/list"
      params: {}
    expect:
      response:
        jsonrpc: "2.0"
        id: "tool-list-1"
        result:
          tools:
            match:arrayContains:name:get_available_best_practice_guides
      stderr: "toBeEmpty"

  - it: "should return deprecation notice when called"
    request:
      jsonrpc: "2.0"
      id: "deprecation-1"
      method: "tools/call"
      params:
        name: "get_available_best_practice_guides"
        arguments: {}
    expect:
      response:
        jsonrpc: "2.0"
        id: "deprecation-1"
        result:
          content:
            - type: "text"
              text: "match:contains:DEPRECATION NOTICE"
          isError: false
      stderr: "toBeEmpty"

  - it: "should mention GitHub Copilot Agent Skills in deprecation notice"
    request:
      jsonrpc: "2.0"
      id: "deprecation-skills-1"
      method: "tools/call"
      params:
        name: "get_available_best_practice_guides"
        arguments: {}
    expect:
      response:
        jsonrpc: "2.0"
        id: "deprecation-skills-1"
        result:
          content:
            - type: "text"
              text: "match:contains:Agent Skills"
          isError: false
      stderr: "toBeEmpty"

  - it: "should include skills directory path in deprecation notice"
    request:
      jsonrpc: "2.0"
      id: "deprecation-url-1"
      method: "tools/call"
      params:
        name: "get_available_best_practice_guides"
        arguments: {}
    expect:
      response:
        jsonrpc: "2.0"
        id: "deprecation-url-1"
        result:
          content:
            - type: "text"
              text: "match:contains:ai-instructions/skills"
          isError: false
      stderr: "toBeEmpty"

  - it: "should list sfcc-cartridge-development skill in deprecation notice"
    request:
      jsonrpc: "2.0"
      id: "deprecation-cartridge-1"
      method: "tools/call"
      params:
        name: "get_available_best_practice_guides"
        arguments: {}
    expect:
      response:
        jsonrpc: "2.0"
        id: "deprecation-cartridge-1"
        result:
          content:
            - type: "text"
              text: "match:contains:sfcc-cartridge-development"
          isError: false
      stderr: "toBeEmpty"

  - it: "should respond quickly with deprecation notice"
    request:
      jsonrpc: "2.0"
      id: "deprecation-perf-1"
      method: "tools/call"
      params:
        name: "get_available_best_practice_guides"
        arguments: {}
    expect:
      response:
        jsonrpc: "2.0"
        id: "deprecation-perf-1"
        result:
          content:
            - type: "text"
              text: "match:type:string"
          isError: false
      performance:
        maxResponseTime: "300ms"
      stderr: "toBeEmpty"
