# ==================================================================================
# SFCC MCP Server - get_hook_reference Tool YAML Tests
# Tests deprecation notice functionality - tools now return deprecation notices
# pointing users to GitHub Copilot Agent Skills
#
# Quick Test Commands:
# aegis "tests/mcp/yaml/get-hook-reference.full-mode.test.mcp.yml" --config "aegis.config.json.json" --verbose
# ==================================================================================
description: "SFCC MCP Server get_hook_reference tool - deprecation notice validation (full-mode)"

tests:
  - it: "should NOT list get_hook_reference tool in available tools"
    request:
      jsonrpc: "2.0"
      id: "tool-list-1"
      method: "tools/list"
      params: {}
    expect:
      response:
        jsonrpc: "2.0"
        id: "tool-list-1"
        result:
          match:extractField: "tools.*.name"
          value: "match:not:arrayContains:get_hook_reference"
      stderr: "toBeEmpty"

  - it: "should return unknown tool error for ocapi_hooks"
    request:
      jsonrpc: "2.0"
      id: "deprecation-ocapi-1"
      method: "tools/call"
      params:
        name: "get_hook_reference"
        arguments:
          guideName: "ocapi_hooks"
    expect:
      response:
        jsonrpc: "2.0"
        id: "deprecation-ocapi-1"
        result:
          content:
            - type: "text"
              text: "match:contains:Unknown tool"
          isError: true
      stderr: "toBeEmpty"

  - it: "should return unknown tool error for scapi_hooks"
    request:
      jsonrpc: "2.0"
      id: "deprecation-scapi-1"
      method: "tools/call"
      params:
        name: "get_hook_reference"
        arguments:
          guideName: "scapi_hooks"
    expect:
      response:
        jsonrpc: "2.0"
        id: "deprecation-scapi-1"
        result:
          content:
            - type: "text"
              text: "match:contains:Unknown tool"
          isError: true
      stderr: "toBeEmpty"

  - it: "should fail fast with unknown tool error"
    request:
      jsonrpc: "2.0"
      id: "deprecation-perf-1"
      method: "tools/call"
      params:
        name: "get_hook_reference"
        arguments:
          guideName: "ocapi_hooks"
    expect:
      response:
        jsonrpc: "2.0"
        id: "deprecation-perf-1"
        result:
          content:
            - type: "text"
              text: "match:contains:Unknown tool"
          isError: true
      performance:
        maxResponseTime: "300ms"
      stderr: "toBeEmpty"
